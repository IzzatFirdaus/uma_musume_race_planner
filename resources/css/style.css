/* ---------------------------------------------------------------------
   Uma Musume Planner - style.css (v3.6 - UI/UX Thematic Update)
   Description: Custom visual styles layered on top of Bootstrap 5, optimized for UI/UX.
   Features: Theming, Dark Mode, Stat Visualization, Dynamic Backgrounds, Frosted Glass Effect
--------------------------------------------------------------------- */

/* ------------------------------
   Font Import: "M PLUS Rounded 1c" for rounded, playful UI
   Rationale: Aligns with official Uma Musume aesthetic for familiarity and engagement.
------------------------------ */
@import url("https://fonts.googleapis.com/css2?family=M+PLUS+Rounded+1c:wght@400;600;700&display=swap");

/* ------------------------------
   Global Design Variables (Light + Dark Mode)
   Rationale: Centralized control for themes, easy maintenance, consistency.
   Naming convention improved for clarity (e.g., --color-primary instead of --primary-color).
------------------------------ */
:root {
  /* Brand Colors */
  --color-primary: #f06292; /* Strong, recognizable brand color */
  --color-secondary: #9575cd; /* Complementary accent color */

  /* Text Colors */
  --color-text-dark: #212529; /* Standard dark text */
  --color-text-light: #ffffff; /* Standard light text */
  --color-text-muted-light: #6c757d; /* Bootstrap default muted for light theme */

  /* Backgrounds & Surfaces (Light Mode) */
  --color-bg-light: #f9f7fd; /* Soft, very light background */
  --color-surface-light-opaque: #ffffff; /* Opaque card/modal background */
  --color-surface-light-glass: rgba(
    255,
    255,
    255,
    0.9
  ); /* INCREASED OPACITY for better text contrast */
  --color-header-light-glass: rgba(
    240,
    98,
    146,
    0.2
  ); /* Slightly stronger header tint, INCREASED OPACITY */
  --color-border-light: rgba(
    149,
    117,
    205,
    0.2
  ); /* Subtle border for light theme forms */
  --color-shadow-light: 0 4px 12px rgba(149, 117, 205, 0.15); /* Soft shadow */

  /* Stat Colors - Consistent and clearly named, aligned with SPEC-05 */
  --color-stat-speed: #3399ff; /* Blue */
  --color-stat-stamina: #dc3545; /* Red */
  --color-stat-power: #fd7e14; /* Orange */
  --color-stat-guts: #e83e8c; /* Magenta */
  --color-stat-wit: #28a745; /* Green */

  /* Background Image URLs - Defined here for easy switching */
  --bg-image-body-light: url("../uploads/app_bg/uma_musume_race_planner_bg_light_1536x1028.png");
  --bg-image-body-dark: url("../uploads/app_bg/uma_musume_race_planner_bg_dark_1536x1028.png");
  --bg-image-component-light: url("../uploads/app_bg/uma_musume_race_planner_bg_light_1028x1536.png");
  --bg-image-component-dark: url("../uploads/app_bg/uma_musume_race_planner_bg_dark_1028x1536.png");

  /* Dark Mode Base - Semantic Naming */
  --color-bg-dark: #1a1a1a; /* Deeper, less harsh dark background */
  --color-surface-dark-glass: rgba(
    30,
    30,
    30,
    0.85
  ); /* Slightly darker, INCREASED OPACITY */
  --color-header-dark-glass: rgba(
    45,
    45,
    45,
    0.9
  ); /* Darker, slightly more opaque header tint, INCREASED OPACITY */
  --color-border-dark: rgba(255, 255, 255, 0.15); /* Border for dark theme */
  --color-input-bg-dark: #3a3a3a; /* Dark input background */
  --color-input-text-dark: #e0e0e0; /* Light text for dark inputs */
  --color-table-header-dark: #4a4a4a; /* Dark table header background */
  --color-table-border-dark: rgba(255, 255, 255, 0.1); /* Dark table border */
  --color-shadow-dark: 0 6px 16px rgba(0, 0, 0, 0.5); /* Stronger shadow for depth */

  /* Neon Theme for Dark Mode - Enhanced Contrast */
  --color-text-neon-dark: #e1d9ff; /* Light lavender for body text, high contrast */
  --color-neon-purple: #b373ff; /* Bright, vibrant purple for highlights */
  --color-list-item-dark-glass: rgba(
    60,
    53,
    74,
    0.9
  ); /* Slightly less transparent for list items, INCREASED OPACITY */
  --color-text-muted-dark: #9e95b3; /* Lighter muted text for dark mode */
  --color-link-dark: #ffffff; /* General link color, bright for visibility */

  /* Common UI Elements */
  --border-radius-base: 0.75rem; /* Slightly smaller, more modern radius */
  --transition-speed: 0.3s ease-in-out; /* Standard transition for smooth changes */
  --backdrop-blur-strength: 15px; /* Slightly STRONGER blur for effect */
}

/* ------------------------------
   Core Body & Background Setup
   Rationale: Foundation for layout and theming.
------------------------------ */
html,
body {
  height: 100%;
}

body {
  position: relative;
  background-color: var(
    --color-bg-light
  ); /* Fallback color, now using variable */
  color: var(--color-text-dark); /* Default text color for light mode */
  font-family: "M PLUS Rounded 1c", sans-serif; /* Applied new font */
  padding-bottom: 50px; /* Ensure space for fixed footer */
  transition: color var(--transition-speed),
    background-color var(--transition-speed); /* Smooth transitions */
  line-height: 1.6; /* Improved readability */
}

body::before {
  content: "";
  position: fixed;
  inset: 0;
  z-index: -1; /* Ensures background stays behind content */
  background-image: var(--bg-image-body-light);
  background-size: cover;
  background-position: center;
  background-repeat: no-repeat;
  transition: background-image var(--transition-speed);
}

/* ------------------------------
   Dark Mode Global Overrides
   Rationale: Defines the dark theme's appearance.
------------------------------ */
body.dark-mode {
  background-color: var(--color-bg-dark); /* Base dark background */
  color: var(--color-text-neon-dark); /* Neon text for dark mode */
  --color-shadow-light: var(--color-shadow-dark); /* Apply dark shadow */
  --color-text-muted-light: var(
    --color-text-muted-dark
  ); /* Apply dark muted text */
}

body.dark-mode::before {
  background-image: var(--bg-image-body-dark);
  opacity: 0.7; /* Slightly higher opacity for dark background image */
}

/* General Dark Mode Typography */
body.dark-mode a {
  color: var(--color-link-dark);
  text-decoration: none; /* Default for links in dark mode unless hovered */
}
body.dark-mode a:hover {
  color: var(--color-neon-purple); /* Highlight with neon purple on hover */
  text-decoration: underline; /* Standard underline for hover */
}
body.dark-mode .text-muted {
  color: var(
    --color-text-muted-dark
  ) !important; /* Specific muted text for dark mode */
}

/* ----------------------------------------------------
   THEMED SURFACES (Frosted Glass Effect)
   Rationale: Consistent application of the core design aesthetic.
   Elements like cards, modals, navbars, and footers share this style.
---------------------------------------------------- */
.header-banner,
.navbar,
.card,
.modal-content,
footer,
.guide-sticky-nav {
  background-image: var(--bg-image-component-light);
  background-size: cover;
  background-position: center;
  box-shadow: var(--color-shadow-light); /* Use variable for shadow */
  border: 1px solid rgba(255, 255, 255, 0.4);
  -webkit-backdrop-filter: blur(var(--backdrop-blur-strength)); /* MOVED UP */
  backdrop-filter: blur(var(--backdrop-blur-strength));
  background-color: var(--color-surface-light-glass);
  border-radius: var(--border-radius-base); /* Use variable for radius */
  transition: background-color var(--transition-speed),
    box-shadow var(--transition-speed), border-color var(--transition-speed); /* Smooth transitions */
}

/* Backdrop-filter fallback for unsupported browsers */
@supports not (backdrop-filter: blur(10px)) {
  .header-banner,
  .navbar,
  .card,
  .modal-content,
  footer,
  .guide-sticky-nav {
    background-color: var(
      --color-surface-light-opaque
    ); /* Fallback to opaque for light mode */
    background-image: none; /* Remove background image if backdrop-filter isn't supported */
  }

  /* Specific dark mode fallback to ensure proper dark theme colors */
  body.dark-mode .header-banner,
  body.dark-mode .navbar,
  body.dark-mode .card,
  body.dark-mode .modal-content,
  body.dark-mode footer,
  body.dark-mode .guide-sticky-nav {
    background-color: var(
      --color-surface-dark-glass
    ); /* Fallback to opaque for dark mode */
    background-image: none; /* Remove background image if backdrop-filter isn't supported */
  }
}
/* End of Backdrop-filter fallback */

/* Card Header Specifics */
.card-header {
  background-color: var(--color-header-light-glass);
  font-weight: 700;
  color: var(--color-primary);
  border-bottom: 1px solid rgba(240, 98, 146, 0.3); /* Slightly stronger border */
  border-top-left-radius: var(
    --border-radius-base
  ); /* Match card border radius */
  border-top-right-radius: var(--border-radius-base);
  padding: 1rem 1.25rem; /* Standard padding */
}

/* Typography on themed surfaces for light mode */
.navbar a.nav-link,
.navbar-brand,
.header-banner h1,
.header-banner p {
  color: var(--color-text-dark) !important; /* Use dark text on light glass */
  text-shadow: 0 1px 4px rgba(0, 0, 0, 0.15); /* Slightly STRONGER shadow for readability */
}

/* Navbar Dark Mode Toggle Label in LIGHT mode */
.navbar .form-check-label {
  color: var(
    --color-text-dark
  ) !important; /* Make "Dark Mode" text dark for contrast */
  text-shadow: none; /* Remove text-shadow for crispness */
}

/* Footer links in LIGHT mode */
footer a {
  color: var(
    --color-primary
  ); /* Use primary color for footer links in light mode */
  font-weight: 600;
  text-decoration: none;
  text-shadow: none; /* Ensure no text-shadow for crispness */
}
footer a:hover {
  text-decoration: underline;
  color: #d84381; /* Darker primary on hover */
}

/* --- Dark Mode Overrides for Themed Surfaces --- */
body.dark-mode .header-banner,
body.dark-mode .navbar,
body.dark-mode .card,
body.dark-mode .modal-content,
body.dark-mode footer,
body.dark-mode .guide-sticky-nav {
  background-image: var(--bg-image-component-dark);
  background-color: var(--color-surface-dark-glass);
  border-color: var(--color-border-dark);
}

body.dark-mode .card-header {
  background-color: var(--color-header-dark-glass);
  border-color: var(--color-border-dark);
  color: var(--color-text-neon-dark);
}

/* Typography on themed surfaces for dark mode */
body.dark-mode .navbar a.nav-link,
body.dark-mode .navbar-brand,
body.dark-mode .header-banner h1,
body.dark-mode .header-banner p {
  color: var(--color-text-neon-dark) !important;
  text-shadow: none; /* No shadow in dark mode for clean neon */
}

/* Navbar Dark Mode Toggle Label in DARK mode */
body.dark-mode .navbar .form-check-label {
  color: var(
    --color-text-neon-dark
  ) !important; /* Use neon text for dark mode */
  text-shadow: none;
}

body.dark-mode footer a {
  color: var(--color-neon-purple); /* Neon purple for footer links */
}

/* --- Navbar Specifics --- */
/* Improve hamburger icon visibility in light mode */
.navbar-toggler-icon {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%2833, 37, 41, 0.75%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
  /* The rgba(33, 37, 41, 0.75) corresponds to a dark grey with some transparency,
     which should contrast well with the light glass background. */
}

/* Ensure it remains light in dark mode, as Bootstrap's navbar-dark handles this */
body.dark-mode .navbar-toggler-icon {
  background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 0.75%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3csvg%3e");
}

/* ------------------------------
   Component: Modals & Tabs
   Rationale: Modals should feel distinct but integrated.
------------------------------ */
.modal-content {
  /* Border and radius handled by themed surfaces */
  overflow: hidden; /* Ensure content respects border-radius */
}

body.dark-mode .modal-header,
body.dark-mode .modal-footer {
  border-color: var(--color-border-dark);
}

/* Active tabs in modals - Ensure strong visual indicator */
.nav-pills .nav-link.active,
.nav-tabs .nav-link.active {
  background-color: var(
    --color-primary
  ); /* Use primary color for active tabs */
  color: var(--color-text-light);
  font-weight: 600;
  border-radius: 999px; /* More pill-shaped */
  padding: 0.5rem 1rem;
}

body.dark-mode .nav-pills .nav-link.active,
body.dark-mode .nav-tabs .nav-link.active {
  background-color: var(
    --color-neon-purple
  ); /* Neon for dark mode active tabs */
  color: var(--color-text-light);
}

.nav-link {
  color: var(--color-text-dark); /* Default tab link color */
  transition: all var(--transition-speed);
}
.nav-link:hover {
  color: var(--color-secondary); /* Accent on hover */
}
body.dark-mode .nav-link {
  color: var(--color-text-neon-dark);
}
body.dark-mode .nav-link:hover {
  color: var(--color-neon-purple);
}

/* ------------------------------
   Component: Logo & Icons
   Rationale: Visual branding consistency.
------------------------------ */
.header-banner .logo {
  height: 80px;
  margin-right: 15px;
  vertical-align: middle;
  border-radius: var(--border-radius-base);
  box-shadow: 0 2px 8px rgba(0, 0, 0, 0.2); /* Consistent shadow */
}

.navbar-brand .logo {
  height: 28px; /* Slightly larger for better visibility in navbar */
  margin-right: 10px; /* Adjusted spacing */
}

.stat-icon {
  font-size: 1.6rem; /* Slightly larger for better impact */
  margin-right: 0.6rem;
  vertical-align: middle;
}

/* ------------------------------
   Component: Buttons & Badges
   Rationale: Clear call-to-actions, consistent states.
------------------------------ */
.btn-uma {
  background-color: var(--color-primary);
  color: var(--color-text-light);
  font-weight: 600;
  border: none; /* Ensure no default border */
  border-radius: 0.5rem; /* Consistent button radius, could be more pill-shaped later */
  padding: 0.75rem 1.5rem; /* More generous padding for touch targets */
  transition: background-color var(--transition-speed), transform 0.1s ease-out; /* Add subtle transform */
  /* Placeholder for potential gradient styles */
  /* background-image: linear-gradient(135deg, var(--color-primary), #d84381); */
}
.btn-uma:hover {
  background-color: #d84381; /* Slightly darker shade on hover */
  color: var(--color-text-light);
  transform: translateY(-1px); /* Subtle lift effect */
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); /* Add shadow on hover */
}
.btn-uma:active {
  background-color: #c43272; /* Even darker on active */
  transform: translateY(0);
  box-shadow: none;
}

/* Status Badges - Clear and accessible colors */
.badge {
  padding: 0.4em 0.7em; /* Consistent badge padding */
  border-radius: 0.375rem; /* Standard Bootstrap radius */
  font-size: 0.8em; /* Appropriate size */
  font-weight: 700;
}

.bg-active {
  background-color: #28a745; /* Green for active/success */
  color: var(--color-text-light);
  /* Added text shadow for better readability on green background */
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}
.bg-finished {
  background-color: #0d6efd; /* Blue for finished/info */
  color: var(--color-text-light);
  /* Added text shadow for better readability on blue background */
  text-shadow: 0 1px 2px rgba(0, 0, 0, 0.2);
}
body.dark-mode .bg-active,
body.dark-mode .bg-finished {
  color: var(--color-text-light); /* Ensure light text in dark mode badges */
  text-shadow: none; /* Remove text shadow in dark mode as neon text handles contrast */
}

/* ------------------------------
   Component: Forms & Autocomplete
   Rationale: Intuitive input, clear states, accessible feedback.
------------------------------ */
.form-control,
.form-select {
  border-radius: 0.5rem; /* Consistent with buttons/tabs */
  border: 1px solid var(--color-border-light); /* Use variable for light border */
  background-color: var(
    --color-surface-light-opaque
  ); /* Opaque for clearer input */
  color: var(--color-text-dark);
  padding: 0.75rem 1rem; /* More generous padding */
  font-size: 1rem; /* Ensure standard font size */
  transition: border-color var(--transition-speed),
    box-shadow var(--transition-speed), background-color var(--transition-speed);
}

.form-control::placeholder {
  color: var(--color-text-muted-light); /* Consistent placeholder color */
  opacity: 0.7; /* Make it slightly more visible than default */
}

.form-control:focus,
.form-select:focus {
  border-color: var(--color-secondary);
  box-shadow: 0 0 0 0.25rem rgba(149, 117, 205, 0.25); /* Stronger, clearer focus ring */
  background-color: var(
    --color-surface-light-opaque
  ); /* Keep opaque on focus */
}

body.dark-mode .form-control,
body.dark-mode .form-select {
  background-color: var(--color-input-bg-dark);
  color: var(--color-input-text-dark);
  border-color: var(--color-border-dark);
}

body.dark-mode .form-control::placeholder {
  color: var(--color-text-muted-dark);
}

/* Autocomplete - Clear, performant, and accessible dropdown */
.autocomplete-container {
  position: relative;
}
.autocomplete-items {
  position: absolute;
  z-index: 1060; /* Higher z-index to appear above most content */
  top: 100%;
  left: 0;
  right: 0;
  max-height: 250px; /* Slightly more space */
  overflow-y: auto;
  -webkit-backdrop-filter: blur(var(--backdrop-blur-strength)); /* MOVED UP */
  backdrop-filter: blur(var(--backdrop-blur-strength));
  background-color: var(
    --color-surface-light-glass
  ); /* Consistent glass effect */
  border: 1px solid rgba(0, 0, 0, 0.1);
  border-radius: 0 0 var(--border-radius-base) var(--border-radius-base); /* Match card radius at bottom */
  box-shadow: var(--color-shadow-light);
}
body.dark-mode .autocomplete-items {
  background-color: var(--color-surface-dark-glass);
  border-color: var(--color-border-dark);
}

.autocomplete-items div {
  padding: 10px 15px; /* More padding */
  cursor: pointer;
  transition: background-color 0.2s ease, color 0.2s ease;
}

.autocomplete-items div:hover,
.autocomplete-active {
  background-color: rgba(
    149,
    117,
    205,
    0.1
  ); /* Light, subtle hover state using secondary color tint */
  color: var(--color-secondary); /* Hint of secondary color on hover */
}
body.dark-mode .autocomplete-items div:hover,
body.dark-mode .autocomplete-active {
  background-color: rgba(
    var(--color-neon-purple),
    0.2
  ); /* Neon tint on hover */
  color: var(--color-neon-purple); /* Neon text on hover */
}

/* ------------------------------
   Component: Tables & Lists
   Rationale: Readability, clear data presentation.
------------------------------ */
.table {
  background-color: transparent; /* Allows card background to show */
  color: var(--color-text-dark); /* Default text for light theme tables */
  border-collapse: separate; /* Allows for border-radius on cells in some cases */
  border-spacing: 0; /* Remove default spacing */
}

.table thead th {
  font-weight: 700;
  background-color: rgba(
    248,
    249,
    250,
    0.9
  ); /* INCREASED OPACITY for better distinction */
  border-bottom: 2px solid rgba(0, 0, 0, 0.15); /* Stronger separator */
  padding: 0.85rem 1rem; /* Slightly more padding for headers */
  color: var(--color-text-dark); /* Ensure dark text on light header */
  position: sticky; /* For sticky headers in scrollable areas if applicable */
  top: 0;
  z-index: 2; /* Ensure header stays above rows */
}

body.dark-mode .table thead th {
  background-color: var(--color-table-header-dark);
  border-color: var(--color-table-border-dark);
  color: var(--color-text-neon-dark); /* Neon text on dark header */
}

.table tbody tr {
  transition: background-color 0.2s ease;
}

.table-hover tbody tr:hover {
  background-color: rgba(
    149,
    117,
    205,
    0.07
  ); /* Slightly more pronounced hover effect */
}

body.dark-mode .table {
  color: var(--color-text-neon-dark);
}

body.dark-mode .table-hover tbody tr:hover {
  background-color: rgba(
    255,
    255,
    255,
    0.1
  ); /* Slightly more visible hover for dark mode */
}

/* Recent Activity List Items - Clear, interactive, and distinct */
.recent-activity-card .list-group {
  background-color: transparent;
  border-radius: var(--border-radius-base); /* Match card radius */
}
.recent-activity-card .list-group-item {
  background-color: transparent; /* Light mode items inherit card background */
  border: 1px solid rgba(0, 0, 0, 0.1); /* Slightly stronger border */
  margin-bottom: -1px; /* Overlap borders for a continuous list */
  transition: background-color 0.2s ease, border-color 0.2s ease;
  padding: 0.85rem 1rem; /* More padding for readability */
  font-size: 0.95rem; /* Slightly larger font size */
  color: var(--color-text-dark); /* Ensure text is dark in light mode */
}
.recent-activity-card .list-group-item:first-child {
  border-top-left-radius: var(--border-radius-base);
  border-top-right-radius: var(--border-radius-base);
}
.recent-activity-card .list-group-item:last-child {
  border-bottom-left-radius: var(--border-radius-base);
  border-bottom-right-radius: var(--border-radius-base);
  margin-bottom: 0;
}
.recent-activity-card .list-group-item:hover {
  background-color: rgba(
    149,
    117,
    205,
    0.05
  ); /* Slightly more visible hover for list items */
}

body.dark-mode .recent-activity-card .list-group-item {
  background-color: var(
    --color-list-item-dark-glass
  ); /* Dark glass for list items */
  border-color: rgba(255, 255, 255, 0.15); /* Slightly stronger border */
  color: var(--color-text-neon-dark); /* Set text to neon color for dark mode */
}
body.dark-mode .recent-activity-card .list-group-item:hover {
  background-color: rgba(
    var(--color-neon-purple),
    0.15
  ); /* Slightly more pronounced neon hover for list items */
}

/* ------------------------------
   Dashboard Panels: Stats & Activity
   Rationale: Clear information display.
------------------------------ */
.quick-stats-number {
  color: var(--color-text-dark); /* Default for light mode */
  font-size: 1.9rem; /* Larger, more prominent numbers */
  font-weight: 700;
  margin-bottom: 0.5rem;
}
.quick-stats-label {
  font-size: 0.95rem; /* Slightly larger */
  color: var(--color-text-muted-light);
}

body.dark-mode .quick-stats-number {
  color: var(--color-link-dark); /* Use white for the numbers in dark mode */
}
body.dark-mode .quick-stats-label {
  color: var(--color-text-muted-dark);
}

/* Override Bootstrap colors in dark mode for visibility (use !important cautiously) */
body.dark-mode .quick-stats-number.text-success,
body.dark-mode .quick-stats-number.text-primary {
  color: var(--color-link-dark) !important; /* Ensure these are visible */
}

/* ------------------------------
   Data Visualization
   Rationale: Clear representation of data, consistent color mapping.
------------------------------ */
.text-speed-blue {
  color: var(--color-stat-speed);
}
.text-stamina-red {
  color: var(--color-stat-stamina);
}
.text-power-orange {
  color: var(--color-stat-power);
}
.text-guts-magenta {
  color: var(--color-stat-guts);
}
.text-wit-green {
  color: var(--color-stat-wit);
}

.plan-stat-bars {
  display: flex;
  gap: 4px;
  margin-top: 0.5rem;
  height: 8px; /* Slightly taller for better visibility */
  border-radius: 4px; /* Rounded ends for the bar container */
  overflow: hidden; /* Ensure bars stay within bounds */
}
.stat-bar {
  flex-grow: 1;
  border-radius: 4px; /* Slightly larger radius for individual bars */
  background-color: #e9ecef; /* Neutral background for empty portion */
}
.stat-bar > div {
  height: 100%;
  border-radius: 4px;
  transition: width 0.5s ease-out; /* Smooth animation for stat changes */
}
/* Individual stat bar colors - now using variable names */
.stat-bar .bar-speed {
  background-color: var(--color-stat-speed);
}
.stat-bar .bar-stamina {
  background-color: var(--color-stat-stamina);
}
.stat-bar .bar-power {
  background-color: var(--color-stat-power);
}
.stat-bar .bar-guts {
  background-color: var(--color-stat-guts);
}
.stat-bar .bar-wit {
  background-color: var(--color-stat-wit);
}

body.dark-mode .stat-bar {
  background-color: rgba(
    255,
    255,
    255,
    0.18
  ); /* Slightly lighter background for dark mode bars, more visible */
}

/* Contextual info for skills - clear, distinct, but not overwhelming */
.skill-context-info {
  font-size: 0.875rem; /* Slightly larger for readability */
  -webkit-backdrop-filter: blur(var(--backdrop-blur-strength)); /* MOVED UP */
  backdrop-filter: blur(var(--backdrop-blur-strength));
  background-color: var(
    --color-surface-light-glass
  ); /* Consistent glass effect */
  color: var(--color-text-dark);
  padding: 0.75rem 1rem; /* More padding */
  margin-top: 1rem; /* More separation */
  border-radius: var(--border-radius-base);
  border-left: 5px solid var(--color-secondary); /* Thicker accent border */
  box-shadow: var(--color-shadow-light); /* Add shadow for depth */
}
body.dark-mode .skill-context-info {
  background: var(--color-surface-dark-glass);
  color: var(--color-text-neon-dark);
  border-left-color: var(--color-neon-purple); /* Neon accent in dark mode */
}

/* ------------------------------
   Utility & Miscellaneous
   Rationale: General helpers and specific page elements.
------------------------------ */
.loading-overlay {
  position: absolute;
  top: 0;
  left: 0;
  right: 0;
  bottom: 0;
  background: rgba(255, 255, 255, 0.9); /* Slightly less transparent */
  display: flex;
  justify-content: center;
  align-items: center;
  z-index: 10;
  border-radius: var(--border-radius-base);
  transition: background var(--transition-speed);
}
body.dark-mode .loading-overlay {
  background: rgba(0, 0, 0, 0.75); /* Darker overlay for dark mode */
}

.guide-sticky-nav {
  /* Inherits frosted glass from themed surfaces */
  border-bottom: 1px solid rgba(0, 0, 0, 0.15); /* Clearer separator */
  box-shadow: 0 2px 6px rgba(0, 0, 0, 0.1); /* Stronger shadow for depth */
  padding: 1rem 0; /* Consistent padding */
  /* --- GUIDE STICKY NAV Z-INDEX AND TOP POSITIONING --- */
  z-index: 1020; /* Ensure guide nav is below main navbar but above content */
  top: var(
    --navbar-height,
    56px
  ); /* Use CSS variable for navbar height, fallback to 56px */
}

body.dark-mode .guide-sticky-nav {
  border-color: var(--color-border-dark);
}

/* Guide Page Specifics - distinct sections for readability */
.section-highlight {
  background: var(--color-surface-light-glass);
  color: var(--color-text-dark);
  padding: 2.5rem; /* More generous padding */
  border-radius: var(--border-radius-base);
  box-shadow: var(--color-shadow-light);
  -webkit-backdrop-filter: blur(var(--backdrop-blur-strength)); /* MOVED UP */
  backdrop-filter: blur(var(--backdrop-blur-strength));
  margin-bottom: 2rem; /* Space between sections */
}
body.dark-mode .section-highlight {
  background: var(--color-surface-dark-glass);
  color: var(--color-text-neon-dark);
}

/* Footer specific improvements */
footer {
  padding: 2rem 0; /* Increased padding for more prominence */
  font-size: 0.95rem; /* Slightly larger font for readability */
}
footer a {
  color: var(
    --color-primary
  ); /* Use primary color for footer links in light mode */
  font-weight: 600;
  text-decoration: none;
  text-shadow: none; /* Ensure no text-shadow for crispness */
}
footer a:hover {
  text-decoration: underline;
  color: #d84381; /* Darker primary on hover */
}
body.dark-mode footer a {
  color: var(--color-neon-purple); /* Neon purple for footer links */
  text-shadow: none; /* No shadow in dark mode */
}

/* --- NEW / CORRECTED STYLES FOR PREVIOUSLY IDENTIFIED ISSUES --- */

/* Plan List Filter Buttons (Dark Mode) */
body.dark-mode .plan-filters .btn-outline-secondary {
  color: var(--color-text-neon-dark); /* Neon text color for outlines */
  border-color: var(--color-border-dark); /* Dark mode border */
}

body.dark-mode .plan-filters .btn-outline-secondary:hover,
body.dark-mode .plan-filters .btn-outline-secondary.active {
  background-color: var(
    --color-neon-purple
  ); /* Neon background for active/hover */
  color: var(--color-text-light); /* White text on neon */
  border-color: var(--color-neon-purple); /* Neon border */
}

/* Recent Activity Text (Dark Mode) */
body.dark-mode .recent-activity-card .list-group-item span {
  color: var(--color-text-neon-dark); /* Ensure description text is neon */
}

body.dark-mode .recent-activity-card .list-group-item .text-muted {
  color: var(
    --color-text-muted-dark
  ) !important; /* Ensure timestamp is muted neon */
}

/* Navbar Dark Mode Toggle Label (Light Mode) */
.navbar .form-check-label {
  color: var(
    --color-text-dark
  ) !important; /* Force dark text in light mode for contrast */
  text-shadow: none; /* Remove any conflicting text-shadow */
}

/* Plan List Table Header Styling (thead) */
.table-hover thead th {
  background-color: var(
    --color-header-light-glass
  ); /* Consistent glass header background */
  color: var(--color-primary); /* Use primary brand color for text */
  border-bottom: 2px solid rgba(240, 98, 146, 0.4); /* Stronger border matching primary tint */
  text-shadow: none; /* Clear text */
}

body.dark-mode .table-hover thead th {
  background-color: var(--color-header-dark-glass); /* Dark mode glass header */
  color: var(--color-text-neon-dark); /* Neon text for dark mode */
  border-bottom: 2px solid var(--color-border-dark); /* Dark mode border */
}

/* Guide Page FAQ Styling */
.accordion-item {
  border: 1px solid var(--color-border-light); /* Consistent border */
  border-radius: var(--border-radius-base); /* Rounded corners */
  margin-bottom: 1rem; /* Space between items */
  -webkit-backdrop-filter: blur(var(--backdrop-blur-strength)); /* MOVED UP */
  backdrop-filter: blur(var(--backdrop-blur-strength));
  background-color: var(
    --color-surface-light-glass
  ); /* Frosted glass background */
  box-shadow: var(--color-shadow-light); /* Add subtle shadow */
  overflow: hidden; /* Ensures child elements respect radius */
}

.accordion-item:last-child {
  margin-bottom: 0; /* No margin after the last item */
}

.accordion-header .accordion-button {
  background-color: var(
    --color-surface-light-glass
  ); /* Maintain glass effect */
  color: var(--color-text-dark); /* Dark text for light mode */
  font-weight: 600;
  padding: 1rem 1.25rem; /* Consistent padding */
  border-bottom: 1px solid transparent; /* No bottom border by default */
  transition: background-color var(--transition-speed),
    color var(--transition-speed), border-bottom-color var(--transition-speed);
}

.accordion-header .accordion-button:not(.collapsed) {
  background-color: var(--color-header-light-glass); /* Highlight when active */
  color: var(--color-primary); /* Primary color when open */
  border-bottom-color: var(--color-border-light); /* Border when open */
  box-shadow: none; /* Remove inner shadow */
}

.accordion-header .accordion-button:focus {
  border-color: var(--color-secondary);
  box-shadow: 0 0 0 0.25rem rgba(149, 117, 205, 0.25); /* Clear focus ring */
}

.accordion-body {
  background-color: transparent; /* Inherit from accordion-item */
  color: var(--color-text-dark); /* Dark text for light mode */
  padding: 1rem 1.25rem;
}

body.dark-mode .accordion-item {
  border-color: var(--color-border-dark);
  background-color: var(--color-surface-dark-glass);
  box-shadow: var(--color-shadow-dark);
}

body.dark-mode .accordion-header .accordion-button {
  background-color: var(--color-surface-dark-glass);
  color: var(--color-text-neon-dark);
}

body.dark-mode .accordion-header .accordion-button:not(.collapsed) {
  background-color: var(--color-header-dark-glass);
  color: var(--color-neon-purple); /* Neon purple when open */
  border-bottom-color: var(--color-border-dark);
}

body.dark-mode .accordion-body {
  background-color: transparent;
  color: var(--color-text-neon-dark);
}

/* Guide Page Glossary Section Styling */
#glossary {
  /* Make the glossary a distinct card */
  background: var(--color-surface-light-glass);
  color: var(--color-text-dark);
  padding: 2.5rem;
  border-radius: var(--border-radius-base);
  box-shadow: var(--color-shadow-light);
  -webkit-backdrop-filter: blur(var(--backdrop-blur-strength)); /* MOVED UP */
  backdrop-filter: blur(var(--backdrop-blur-strength));
  margin-bottom: 2rem; /* Ensure space after it */
}

#glossary h3 {
  color: var(--color-primary); /* Use primary color for header */
  margin-bottom: 1.5rem;
}

#glossary dt {
  font-weight: 700;
  color: var(--color-secondary); /* Accent color for terms */
  margin-bottom: 0.5rem; /* Space between term and definition */
}

#glossary dd {
  margin-bottom: 1.5rem; /* Space after definition */
  padding-left: 1rem; /* Indent definition slightly */
  border-left: 3px solid rgba(149, 117, 205, 0.2); /* Subtle accent line */
}

body.dark-mode #glossary {
  background: var(--color-surface-dark-glass);
  color: var(--color-text-neon-dark);
  box-shadow: var(--color-shadow-dark);
}

body.dark-mode #glossary h3 {
  color: var(--color-neon-purple); /* Neon purple for header */
}

body.dark-mode #glossary dt {
  color: var(--color-text-neon-dark); /* Neon text for terms */
}

body.dark-mode #glossary dd {
  border-left: 3px solid rgba(var(--color-neon-purple), 0.4); /* Neon accent line */
}

/* Guide Page Related Links (bottom section, not footer) */
.container > .text-center.text-muted.small {
  /* Target only this specific block */
  background: var(--color-surface-light-glass); /* Apply glass effect */
  padding: 2rem; /* Consistent padding */
  border-radius: var(--border-radius-base); /* Consistent radius */
  box-shadow: var(--color-shadow-light);
  -webkit-backdrop-filter: blur(var(--backdrop-blur-strength)); /* MOVED UP */
  backdrop-filter: blur(var(--backdrop-blur-strength));
  margin-top: 2rem !important; /* Ensure spacing from previous section */
  margin-bottom: 2rem !important; /* Ensure spacing before footer */
}

.container > .text-center.text-muted.small p {
  color: var(--color-text-dark); /* Ensure text is dark */
  margin-bottom: 1rem; /* Space between paragraphs */
}

.container > .text-center.text-muted.small p:last-child {
  margin-bottom: 0;
}

.container > .text-center.text-muted.small a {
  color: var(--color-secondary); /* Use secondary color for links */
  font-weight: 600;
  text-decoration: none;
  transition: color var(--transition-speed);
}

.container > .text-center.text-muted.small a:hover {
  color: var(--color-primary); /* Hover effect using primary */
  text-decoration: underline;
}

.container > .text-center.text-muted.small a i {
  font-size: 1.1em; /* Slightly larger icon */
  vertical-align: middle;
}

/* --- Dark Mode Specifics for Guide Page Related Links --- */
body.dark-mode .container > .text-center.text-muted.small {
  background: var(--color-surface-dark-glass);
  color: var(
    --color-text-neon-dark
  ); /* General text color for this section in dark mode */
  box-shadow: var(--color-shadow-dark);
}

body.dark-mode .container > .text-center.text-muted.small p {
  color: var(--color-text-neon-dark); /* Ensure paragraphs also get neon text */
}

body.dark-mode .container > .text-center.text-muted.small a {
  color: var(--color-neon-purple); /* Neon purple for the links */
}

body.dark-mode .container > .text-center.text-muted.small a:hover {
  color: var(
    --color-link-dark
  ); /* White on hover for better contrast with neon purple */
}

/* --- Global Navbar Z-Index for higher precedence --- */
/* The .navbar class itself already has sticky-top from navbar.php */
.navbar {
  z-index: 1050; /* Higher than Bootstrap's default modal, ensures it stays on top */
}

/* Add a CSS variable for navbar height for better consistency */
/* This can be set dynamically by JS if needed, but a fixed value is a good start */
body {
  --navbar-height: 56px; /* Approx default Bootstrap navbar height */
}
@media (min-width: 992px) {
  /* Adjust for larger screens if navbar height changes */
  body {
    --navbar-height: 56px; /* Keep consistent or adjust if navbar grows */
  }
}