<!--components\plan-list.php-->
<div class="card shadow-sm mb-4">
  <div class="card-header bg-uma text-white d-flex justify-content-between align-items-center">
    <span class="fw-bold">Your Race Plans</span>
    <button class="btn btn-light btn-sm" id="createPlanBtn" aria-label="Create New Plan">
      <i class="bi bi-plus-circle me-1" aria-hidden="true"></i> Create New
    </button>
  </div>

  <div class="card-body">
    <div class="table-responsive">
      <table class="table table-hover align-middle" aria-label="List of Race Plans">
        <thead class="table-light">
          <tr>
            <th scope="col">Name</th>
            <th scope="col">Career</th>
            <th scope="col">Class</th>
            <th scope="col">Race</th>
            <th scope="col">Status</th>
            <th scope="col">Actions</th>
          </tr>
        </thead>
        <tbody id="planTableBody">
          <?php if (!empty($plans)): ?>
            <?php foreach ($plans as $plan): ?>
              <tr class="plan-card" data-id="<?= htmlspecialchars($plan['id']) ?>">
                <td>
                  <div class="d-flex align-items-center">
                    <div class="me-3">
                      <?php
                        $status = $plan['status'] ?? '';
                        switch ($status) {
                          case 'Active':   $iconColor = 'text-success'; break;
                          case 'Planning': $iconColor = 'text-info'; break;
                          case 'Finished': $iconColor = 'text-primary'; break;
                          default:         $iconColor = 'text-secondary'; break;
                        }
                      ?>
                      <i class="bi bi-person-circle fs-4 <?= $iconColor ?>" aria-hidden="true"></i>
                    </div>
                    <div>
                      <div class="fw-bold"><?= htmlspecialchars($plan['name'] ?? '') ?></div>
                      <div class="text-muted small"><?= htmlspecialchars($plan['race_name'] ?? '') ?></div>
                    </div>
                  </div>
                </td>

                <td><?= htmlspecialchars(ucfirst($plan['career_stage'] ?? '')) ?></td>

                <td>
                  <?php
                    $class = strtolower($plan['class'] ?? '');
                    switch ($class) {
                      case 'star':     $classBadge = 'bg-warning text-dark'; break;
                      case 'gold':     $classBadge = 'bg-orange text-white'; break;
                      case 'platinum': $classBadge = 'bg-info'; break;
                      case 'legend':   $classBadge = 'bg-dark'; break;
                      default:         $classBadge = 'bg-secondary'; break;
                    }
                  ?>
                  <span class="badge <?= $classBadge ?>">
                    <?= strtoupper(htmlspecialchars($plan['class'] ?? '')) ?>
                  </span>
                </td>

                <td><?= htmlspecialchars($plan['race_name'] ?? '') ?></td>

                <td>
                  <?php
                    $status = $plan['status'] ?? '';
                    switch ($status) {
                      case 'Active':   $statusBadge = 'bg-success'; break;
                      case 'Planning': $statusBadge = 'bg-info'; break;
                      case 'Finished': $statusBadge = 'bg-primary'; break;
                      case 'Draft':    $statusBadge = 'bg-secondary'; break;
                      case 'Abandoned':$statusBadge = 'bg-danger'; break;
                      default:         $statusBadge = 'bg-light text-dark'; break;
                    }
                  ?>
                  <span class="badge <?= $statusBadge ?>" title="Status: <?= htmlspecialchars($status) ?>">
                    <?= htmlspecialchars($status) ?>
                  </span>
                </td>

                <td>
                  <div class="d-flex gap-2" role="group" aria-label="Actions for <?= htmlspecialchars($plan['name']) ?>">
                    <button class="btn btn-sm btn-outline-primary view-btn" data-id="<?= $plan['id'] ?>" title="View Plan">
                      <i class="bi bi-eye" aria-hidden="true"></i>
                      <span class="visually-hidden">View</span>
                    </button>
                    <button class="btn btn-sm btn-outline-warning edit-btn" data-id="<?= $plan['id'] ?>" title="Edit Plan">
                      <i class="bi bi-pencil" aria-hidden="true"></i>
                      <span class="visually-hidden">Edit</span>
                    </button>
                    <button class="btn btn-sm btn-outline-danger delete-btn" data-id="<?= $plan['id'] ?>" title="Delete Plan">
                      <i class="bi bi-trash" aria-hidden="true"></i>
                      <span class="visually-hidden">Delete</span>
                    </button>
                  </div>
                </td>
              </tr>
            <?php endforeach; ?>
          <?php else: ?>
            <tr>
              <td colspan="6" class="text-center py-4">
                <i class="bi bi-calendar-x fs-1 text-muted" aria-hidden="true"></i>
                <p class="mt-2 mb-2">No race plans found</p>
                <button class="btn btn-uma" id="createFirstPlanBtn" aria-label="Create First Plan">
                  <i class="bi bi-plus-circle me-1"></i> Create First Plan
                </button>
              </td>
            </tr>
          <?php endif; ?>
        </tbody>
      </table>
    </div>
  </div>
</div>
